<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="Description" content="Enter your description here"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<link rel="stylesheet" href="css/style.css">
<title>Hospedaje</title>
</head>
<body>
    <header>
        <% if ( tipoUsuario === "admin") { %>
            <%- include('Navbar'); %>
        <% } else if ( tipoUsuario === "mesero") { %>
            <%- include('NavarMesero'); %>
        <% } %>
    </header>
    <div class="alineacion container">
        <button class="Pagos" data-toggle="tooltip" data-placement="top" title="Imprimir lista Hospedaje"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M12.5294 2C16.5225 2 18.519 2 19.7595 3.17157C21 4.34315 21 6.22876 21 10V14C21 17.7712 21 19.6569 19.7595 20.8284C18.519 22 16.5225 22 12.5294 22H11.4706C7.47751 22 5.48098 22 4.24049 20.8284C3 19.6569 3 17.7712 3 14L3 10C3 6.22876 3 4.34315 4.24049 3.17157C5.48098 2 7.47752 2 11.4706 2L12.5294 2Z" stroke="#000000" stroke-width="1.5" stroke-linecap="round"/>
            <path d="M8 7H16" stroke="#000000" stroke-width="1.5" stroke-linecap="round"/>
            <path d="M8 12H16" stroke="#000000" stroke-width="1.5" stroke-linecap="round"/>
            <path d="M8 17H12" stroke="#000000" stroke-width="1.5" stroke-linecap="round"/>
            </svg></button>
    </div>
        <div class="container espacio">
            <h2>Habitaciones</h2>
            <div class="habitacion">
                <a href="/HB-1">
                    <div class="HB col">
                        <div class="Habitacion"><h4>HB 1</h4></div>
                    </div> 
                </a>
                <a href="/HB-2">
                    <div class="HB col" >
                        <div class="Habitacion"><h4>HB 2</h4></div>
                    </div> 
                </a>
                <a href="/HB-3">
                    <div class="HB col">
                        <div class="Habitacion"><h4>HB 3</h4></div>
                    </div> 
                </a>
                <a href="/HB-4">
                    <div class="HB col">
                        <div class="Habitacion"><h4>HB 4</h4></div>
                    </div> 
                </a>
                <a href="/HB-5">
                    <div class="HB col">
                        <div class="Habitacion"><h4>HB 5</h4></div>
                    </div> 
                </a>
                <a href="/HB-6">
                    <div class="HB col">
                        <div class="Habitacion"><h4>HB 6</h4></div>
                    </div> 
                </a>
                <a href="/HB-7">
                    <div class="HB">
                        <div class="Habitacion"><h4>HB 7</h4></div>
                    </div> 
                </a>
                <a href="/HB-8">
                    <div class="HB">
                        <div class="Habitacion"><h4>HB 8</h4></div>
                    </div> 
                </a>
                <a href="/HB-9">
                    <div class="HB">
                        <div class="Habitacion"><h4>HB 9</h4></div>
                    </div> 
                </a>
                <a href="/HB-10">
                    <div class="HB">
                        <div class="Habitacion"><h4>HB 10</h4></div>
                    </div> 
                </a>
                <a href="/HB-11">
                    <div class="HB col">
                        <div class="Habitacion"><h4>HB 11</h4></div>
                    </div> 
                </a>
                <a href="/HB-12">
                    <div class="HB col">
                        <div class="Habitacion"><h4>HB 12</h4></div>
                    </div> 
                </a>
                <a href="/HB-13">
                    <div class="HB">
                        <div class="Habitacion"><h4>HB 13</h4></div>
                    </div> 
                </a>
                </div>
                <h2>Cabañas</h2>
                <div class="habitacion">
                <a href="/CB-14">
                    <div class="HB">
                        <div class="Habitacion"><h4>CB 14</h4></div>
                    </div> 
                </a>
                <a href="/CB-15">
                    <div class="HB">
                        <div class="Habitacion"><h4>CB 15</h4></div>
                    </div> 
                </a>
                <a href="/CB-16">
                    <div class="HB">
                        <div class="Habitacion"><h4>CB 16</h4></div>
                    </div> 
                </a>
                <a href="/CB-17">
                    <div class="HB">
                        <div class="Habitacion"><h4>CB 17</h4></div>
                    </div> 
                </a>
                <a href="/CB-18">
                    <div class="HB">
                        <div class="Habitacion"><h4>CB 18</h4></div>
                    </div> 
                </a>
                <a href="/CB-19">
                    <div class="HB">
                        <div class="Habitacion"><h4>CB 19</h4></div>
                    </div> 
                </a>
                <a href="/CB-20">
                    <div class="HB">
                        <div class="Habitacion"><h4>CB 20</h4></div>
                    </div> 
                </a>
                <a href="/CB-21">
                    <div class="HB">
                        <div class="Habitacion"><h4>CB 21</h4></div>
                    </div> 
                </a>
                <a href="/CB-22">
                    <div class="HB">
                        <div class="Habitacion"><h4>CB 22</h4></div>
                    </div> 
                </a>
                <a href="/CB-23">
                    <div class="HB">
                        <div class="Habitacion"><h4>CB 23</h4></div>
                    </div> 
                </a>
                <a href="/CB-24">
                    <div class="HB">
                        <div class="Habitacion"><h4>CB 24</h4></div>
                    </div> 
                </a>
                <a href="/CB-25">
                <div class="HB">
                    <div class="Habitacion"><h4>CB 25</h4></div>
                </div> 
                </a>
        </div>
<div>
    <div class="container espacio">
        <h2>Habitaciones Entrantes</h2>
        <div class="habitacion">
            <a href="/EHB-1">
                <div class="HB col">
                    <div class="Habitacion"><h4>101</h4></div>
                </div> 
            </a>
            <a href="/EHB-2">
                <div class="HB col" >
                    <div class="Habitacion"><h4>102</h4></div>
                </div> 
            </a>
            <a href="/EHB-3">
                <div class="HB col">
                    <div class="Habitacion"><h4>103</h4></div>
                </div> 
            </a>
            <a href="/EHB-4">
                <div class="HB col">
                    <div class="Habitacion"><h4>104</h4></div>
                </div> 
            </a>
            <a href="/EHB-5">
                <div class="HB col">
                    <div class="Habitacion"><h4>105</h4></div>
                </div> 
            </a>
            <a href="/EHB-6">
                <div class="HB col">
                    <div class="Habitacion"><h4>106</h4></div>
                </div> 
            </a>
            <a href="/EHB-7">
                <div class="HB">
                    <div class="Habitacion"><h4>107</h4></div>
                </div> 
            </a>
            <a href="/EHB-8">
                <div class="HB">
                    <div class="Habitacion"><h4>108</h4></div>
                </div> 
            </a>
            <a href="/EHB-9">
                <div class="HB">
                    <div class="Habitacion"><h4>109</h4></div>
                </div> 
            </a>
            <a href="/EHB-10">
                <div class="HB">
                    <div class="Habitacion"><h4>110</h4></div>
                </div> 
            </a>
            <a href="/EHB-11">
                <div class="HB col">
                    <div class="Habitacion"><h4>111</h4></div>
                </div> 
            </a>
            <a href="/EHB-12">
                <div class="HB col">
                    <div class="Habitacion"><h4>112</h4></div>
                </div> 
            </a>
            <a href="/EHB-13">
                <div class="HB">
                    <div class="Habitacion"><h4>113</h4></div>
                </div> 
            </a>
            </div>
            <h2>Cabañas Entrantes</h2>
            <div class="habitacion">
            <a href="/ECB-14">
                <div class="HB">
                    <div class="Habitacion"><h4>114</h4></div>
                </div> 
            </a>
            <a href="/ECB-15">
                <div class="HB">
                    <div class="Habitacion"><h4>115</h4></div>
                </div> 
            </a>
            <a href="/ECB-16">
                <div class="HB">
                    <div class="Habitacion"><h4>116</h4></div>
                </div> 
            </a>
            <a href="/ECB-17">
                <div class="HB">
                    <div class="Habitacion"><h4>117</h4></div>
                </div> 
            </a>
            <a href="/ECB-18">
                <div class="HB">
                    <div class="Habitacion"><h4>118</h4></div>
                </div> 
            </a>
            <a href="/ECB-19">
                <div class="HB">
                    <div class="Habitacion"><h4>119</h4></div>
                </div> 
            </a>
            <a href="/ECB-20">
                <div class="HB">
                    <div class="Habitacion"><h4>120</h4></div>
                </div> 
            </a>
            <a href="/ECB-21">
                <div class="HB">
                    <div class="Habitacion"><h4>121</h4></div>
                </div> 
            </a>
            <a href="/ECB-22">
                <div class="HB">
                    <div class="Habitacion"><h4>122</h4></div>
                </div> 
            </a>
            <a href="/ECB-23">
                <div class="HB">
                    <div class="Habitacion"><h4>123</h4></div>
                </div> 
            </a>
            <a href="/ECB-24">
                <div class="HB">
                    <div class="Habitacion"><h4>124</h4></div>
                </div> 
            </a>
            <a href="/ECB-25">
            <div class="HB">
                <div class="Habitacion"><h4>125</h4></div>
            </div> 
            </a>
    </div>
</div>
    <div class="container espacio">       
        <%
        let cantidadAdultos = 0;
        let cantidadNiños = 0;
        let cantidadBebes = 0;
        
        // Configurar la zona horaria para Bogotá
        const timeZoneOffset = -5 * 60; // Bogotá tiene una diferencia de -5 horas respecto a UTC
        const fechaHoy = new Date(new Date().getTime() + timeZoneOffset * 60 * 1000); // Fecha actual en Bogotá
        const fechaHoyStr = fechaHoy.toISOString().split('T')[0];
        const horaActual = new Date().toLocaleString("es-CO", { timeZone: "America/Bogota", hour: "numeric", hour12: false }); // Obtener la hora actual en Bogotá
        let fechaSalidaStr = ""
        Huesped.forEach((Huesped) => {
            const Ingreso = Huesped.Ingreso.split('-'); // Suponiendo que el formato es YYYY-MM-DD
            const añoI = parseInt(Ingreso[0]);
            const mesI = parseInt(Ingreso[1]) - 1; // Los meses en JavaScript van de 0 a 11
            const diaI = parseInt(Ingreso[2]);
            const fechaIngreso = new Date(añoI, mesI, diaI, 0, 0, 0, 0); // Fecha de ingreso en Bogotá
            fechaIngreso.setTime(fechaIngreso.getTime() + timeZoneOffset * 60 * 1000); // Ajustar a la zona horaria de Bogotá
            const fechaIngresoStr = fechaIngreso.toISOString().split('T')[0];
            
            const partesFecha = Huesped.Salida.split('-'); // Suponiendo que el formato es YYYY-MM-DD
            const año = parseInt(partesFecha[0]);
            const mes = parseInt(partesFecha[1]) - 1; // Los meses en JavaScript van de 0 a 11
            const dia = parseInt(partesFecha[2]);
            const fechaSalida = new Date(año, mes, dia, 23, 59, 59, 999); // Fecha de salida en Bogotá
            fechaSalida.setTime(fechaSalida.getTime() + timeZoneOffset * 60 * 1000); // Ajustar a la zona horaria de Bogotá
            fechaSalidaStr = fechaSalida.toISOString().split('T')[0];
            
            // Verificar si la fecha de salida del huésped es mayor o igual a la fecha de hoy
            // y la hora de salida es antes de las 3:00 p. m.
            if ((fechaSalidaStr >= fechaHoyStr) && (horaActual < 15) && (fechaIngresoStr <= fechaHoyStr)) {
                cantidadAdultos += Huesped.Adultos;
                cantidadNiños += Huesped.Niños;
                cantidadBebes += Huesped.Bebes;
            } else if ((fechaIngresoStr <= fechaHoyStr) && (fechaSalidaStr > fechaHoyStr)) {
                cantidadAdultos += Huesped.Adultos;
                cantidadNiños += Huesped.Niños;
                cantidadBebes += Huesped.Bebes;
            }
        });
    %>
        <%
        let fechaIngresoDS = ""
        let cantidadAdultosD = 0;
        let cantidadNiñosD = 0;
        let cantidadBebesD = 0;
        DS.forEach((DS) => {
            fechaIngresoDS = new Date(DS.Ingreso);
            const fechaHoy = new Date();
            const horaActual = fechaHoy.getHours();
            const partesFecha = DS.Ingreso.split('-'); // Suponiendo que el formato es YYYY-MM-DD
            const año = parseInt(partesFecha[0]);
            const mes = parseInt(partesFecha[1]) - 1; // Los meses en JavaScript van de 0 a 11
            const dia = parseInt(partesFecha[2]);
            fechaIngresoDS = new Date(año, mes, dia);
            if (fechaIngresoDS.getFullYear() === fechaHoy.getFullYear() &&
                fechaIngresoDS.getMonth() === fechaHoy.getMonth() &&
                fechaIngresoDS.getDate() === fechaHoy.getDate() && horaActual < 17) {
                    cantidadAdultosD += DS.Adultos;
                    cantidadNiñosD += DS.Niños;
                    cantidadBebesD += DS.Bebes;
            }
        });
        %>
    <h5 class="anuncio">Hospedaje</h5>
    <h5 class="anuncio">Adultos:<%= cantidadAdultos %>  Niños:<%= cantidadNiños %> Bebes: <%= cantidadBebes %></h5>
    <h5 class="anuncio">Dias de sol</h5>
    <h5 class="anuncio">Adultos:<%= cantidadAdultosD %>  Niños:<%= cantidadNiñosD %> Bebes: <%= cantidadBebesD %></h5>
    </div>

</body>
</html>